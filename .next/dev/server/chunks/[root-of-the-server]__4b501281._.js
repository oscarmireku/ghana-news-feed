module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/node:stream [external] (node:stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}),
"[externals]/buffer [external] (buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}),
"[externals]/string_decoder [external] (string_decoder, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("string_decoder", () => require("string_decoder"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/node:assert [external] (node:assert, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:assert", () => require("node:assert"));

module.exports = mod;
}),
"[externals]/node:net [external] (node:net, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:net", () => require("node:net"));

module.exports = mod;
}),
"[externals]/node:http [external] (node:http, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:http", () => require("node:http"));

module.exports = mod;
}),
"[externals]/node:querystring [external] (node:querystring, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:querystring", () => require("node:querystring"));

module.exports = mod;
}),
"[externals]/node:events [external] (node:events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}),
"[externals]/node:diagnostics_channel [external] (node:diagnostics_channel, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:diagnostics_channel", () => require("node:diagnostics_channel"));

module.exports = mod;
}),
"[externals]/node:util [external] (node:util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}),
"[externals]/node:tls [external] (node:tls, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:tls", () => require("node:tls"));

module.exports = mod;
}),
"[externals]/node:buffer [external] (node:buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:buffer", () => require("node:buffer"));

module.exports = mod;
}),
"[externals]/node:zlib [external] (node:zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:zlib", () => require("node:zlib"));

module.exports = mod;
}),
"[externals]/node:perf_hooks [external] (node:perf_hooks, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:perf_hooks", () => require("node:perf_hooks"));

module.exports = mod;
}),
"[externals]/node:util/types [external] (node:util/types, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:util/types", () => require("node:util/types"));

module.exports = mod;
}),
"[externals]/node:crypto [external] (node:crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:crypto", () => require("node:crypto"));

module.exports = mod;
}),
"[externals]/node:worker_threads [external] (node:worker_threads, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:worker_threads", () => require("node:worker_threads"));

module.exports = mod;
}),
"[externals]/node:http2 [external] (node:http2, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:http2", () => require("node:http2"));

module.exports = mod;
}),
"[externals]/node:async_hooks [external] (node:async_hooks, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:async_hooks", () => require("node:async_hooks"));

module.exports = mod;
}),
"[externals]/node:console [external] (node:console, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:console", () => require("node:console"));

module.exports = mod;
}),
"[externals]/node:fs/promises [external] (node:fs/promises, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:fs/promises", () => require("node:fs/promises"));

module.exports = mod;
}),
"[externals]/node:path [external] (node:path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:path", () => require("node:path"));

module.exports = mod;
}),
"[externals]/node:timers [external] (node:timers, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:timers", () => require("node:timers"));

module.exports = mod;
}),
"[externals]/node:dns [external] (node:dns, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:dns", () => require("node:dns"));

module.exports = mod;
}),
"[externals]/fs [external] (fs, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}),
"[externals]/path [external] (path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}),
"[project]/news/src/app/api/news/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "GET",
    ()=>GET,
    "dynamic",
    ()=>dynamic
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/news/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/news/node_modules/cheerio/dist/esm/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/news/node_modules/cheerio/dist/esm/load-parse.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/fs [external] (fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/path [external] (path, cjs)");
;
;
;
;
const dynamic = 'force-dynamic';
// ---------------------------------------------------------------------------
// Helpers
// ---------------------------------------------------------------------------
function normalizeTitle(title) {
    return title.toLowerCase().replace(/[^a-z0-9]/g, '');
}
function resolveUrl(base, relative) {
    try {
        return new URL(relative, base).href;
    } catch  {
        return relative;
    }
}
// Parse publication date from various formats
function parsePublicationDate(dateStr) {
    if (!dateStr || dateStr.trim() === '') {
        return {
            timestamp: Date.now(),
            display: 'Recent'
        };
    }
    const cleaned = dateStr.trim();
    const d = new Date(cleaned);
    if (!isNaN(d.getTime())) {
        const timestamp = d.getTime();
        const display = d.toLocaleString('en-US', {
            hour: 'numeric',
            minute: '2-digit',
            month: 'short',
            day: 'numeric'
        });
        return {
            timestamp,
            display
        };
    }
    // If we can't parse it, return current time
    return {
        timestamp: Date.now(),
        display: 'Recent'
    };
}
// Fallback: Fetch article page to find og:image
// Fallback: Fetch article page to find og:image and parsing date
async function fetchArticleMetadata(link) {
    try {
        const res = await fetch(link, {
            headers: {
                'User-Agent': 'Mozilla/5.0'
            }
        });
        if (!res.ok) return {
            image: null
        };
        const html = await res.text();
        const $ = __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"](html);
        // Image
        const image = $('meta[property="og:image"]').attr('content') || $('meta[name="twitter:image"]').attr('content') || null;
        // Date
        let dateStr = $('meta[property="og:article:published_time"]').attr('content') || $('meta[property="article:published_time"]').attr('content') || $('meta[name="article:published_time"]').attr('content') || $('meta[itemprop="datePublished"]').attr('content') || $('meta[name="pubdate"]').attr('content') || $('#date').text() || $('time').first().attr('datetime');
        let timestamp;
        let time;
        if (dateStr) {
            const parsed = parsePublicationDate(dateStr);
            if (parsed.display !== 'Recent') {
                timestamp = parsed.timestamp;
                time = parsed.display;
            }
        }
        return {
            image,
            timestamp,
            time
        };
    } catch  {
        return {
            image: null
        };
    }
}
// ---------------------------------------------------------------------------
// Source: GhanaWeb (Scrape Sections)
// ---------------------------------------------------------------------------
async function scrapeGhanaWeb() {
    const sections = [
        {
            name: 'News',
            url: 'https://www.ghanaweb.com/GhanaHomePage/NewsArchive/'
        },
        {
            name: 'Sports',
            url: 'https://www.ghanaweb.com/GhanaHomePage/SportsArchive/'
        },
        {
            name: 'Business',
            url: 'https://www.ghanaweb.com/GhanaHomePage/business/'
        }
    ];
    const stories = [];
    const seenLinks = new Set();
    await Promise.all(sections.map(async (sec)=>{
        try {
            const res = await fetch(sec.url, {
                headers: {
                    'User-Agent': 'Mozilla/5.0'
                }
            });
            const html = await res.text();
            const $ = __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"](html);
            // Strategy: 
            // 1. Try known containers (desktop view)
            // 2. Fallback: Find ALL links that look like articles in this section
            let candidates = $('.inner-lead, .sub-menu-list__news li, .news_listing .inner, #leads .inner, .news-list li');
            if (candidates.length === 0) {
                // Fallback: finding any link containing 'Article' or looking like a news path
                // GhanaWeb articles: /GhanaHomePage/NewsArchive/artikel.php?ID=... or similar slugs
                candidates = $('a[href*="artikel.php"], a[href*="/NewsArchive/"], a[href*="/SportsArchive/"], a[href*="/business/"]');
            }
            candidates.slice(0, 10).each((_, el)=>{
                const a = $(el).is('a') ? $(el) : $(el).find('a').first();
                const link = a.attr('href');
                let title = a.attr('title') || a.text().trim();
                if (!title || title.length < 5) {
                    title = $(el).find('h2, h3, h4, p').text().trim();
                }
                let image = $(el).find('img').attr('src');
                if (!image) {
                    // Check parent for image
                    image = $(el).closest('div, li').find('img').attr('src');
                }
                // Extract publication date - GhanaWeb typically has date in .date, .time, or time elements
                let dateStr = $(el).find('.date, .time, time, .published, .post-date').first().text().trim();
                if (!dateStr) {
                    // Check for datetime attribute in time element
                    dateStr = $(el).find('time').attr('datetime') || '';
                }
                const { timestamp, display } = parsePublicationDate(dateStr);
                if (link && title && title.length > 10 && !link.includes('javascript') && !link.includes('#')) {
                    const fullLink = resolveUrl('https://www.ghanaweb.com', link);
                    if (seenLinks.has(fullLink)) return;
                    seenLinks.add(fullLink);
                    if (image) image = resolveUrl('https://cdn.ghanaweb.com', image);
                    stories.push({
                        id: `gw-${stories.length + Math.random()}`,
                        source: 'GhanaWeb',
                        title,
                        link: fullLink,
                        image: image || null,
                        time: display,
                        timestamp,
                        section: sec.name
                    });
                }
            });
        } catch (e) {
            console.error(`GhanaWeb ${sec.name} Error:`, e);
        }
    }));
    return stories;
}
// ---------------------------------------------------------------------------
// Source: AdomOnline (RSS Sections)
// ---------------------------------------------------------------------------
async function scrapeAdomOnline() {
    const feeds = [
        {
            name: 'News',
            url: 'https://www.adomonline.com/category/news/feed/'
        },
        {
            name: 'Sports',
            url: 'https://www.adomonline.com/category/sports/feed/'
        },
        {
            name: 'Business',
            url: 'https://www.adomonline.com/category/business/feed/'
        }
    ];
    const stories = [];
    const seenLinks = new Set();
    await Promise.all(feeds.map(async (feed)=>{
        try {
            const res = await fetch(feed.url, {
                headers: {
                    'User-Agent': 'Mozilla/5.0'
                }
            });
            const xml = await res.text();
            const $ = __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"](xml, {
                xmlMode: true
            });
            $('item').slice(0, 5).each((_, el)=>{
                const title = $(el).find('title').text().trim();
                const link = $(el).find('link').text().trim();
                const pubDate = $(el).find('pubDate').text().trim();
                if (seenLinks.has(link)) return;
                seenLinks.add(link);
                let timestamp = Date.now();
                let timeDisplay = 'Recent';
                if (pubDate) {
                    const d = new Date(pubDate);
                    if (!isNaN(d.getTime())) {
                        timestamp = d.getTime();
                        timeDisplay = d.toLocaleString('en-US', {
                            hour: 'numeric',
                            minute: '2-digit',
                            month: 'short',
                            day: 'numeric'
                        });
                    }
                }
                let image = $(el).find('media\\:content').attr('url') || $(el).find('media\\:thumbnail').attr('url');
                if (!image) {
                    const content = $(el).find('content\\:encoded').text();
                    const match = content.match(/src="([^"]+)"/);
                    if (match) image = match[1];
                }
                stories.push({
                    id: `adom-${stories.length + Math.random()}`,
                    source: 'AdomOnline',
                    title,
                    link,
                    image: image || null,
                    time: timeDisplay,
                    timestamp,
                    section: feed.name
                });
            });
        } catch (e) {
            console.error(`AdomOnline ${feed.name} Error:`, e);
        }
    }));
    return stories;
}
// ---------------------------------------------------------------------------
// Source: PeaceFM (HTML Scrape Sections)
// ---------------------------------------------------------------------------
async function scrapePeaceFM() {
    const sections = [
        {
            name: 'News',
            url: 'https://www.peacefmonline.com/pages/local/'
        },
        {
            name: 'Sports',
            url: 'https://www.peacefmonline.com/pages/sports/'
        },
        {
            name: 'Business',
            url: 'https://www.peacefmonline.com/pages/business/'
        }
    ];
    const stories = [];
    const seenLinks = new Set();
    await Promise.all(sections.map(async (sec)=>{
        try {
            const res = await fetch(sec.url, {
                headers: {
                    'User-Agent': 'Mozilla/5.0'
                }
            });
            const html = await res.text();
            const $ = __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"](html);
            // Try generic containers
            let candidates = $('.jeg_post, .post-item, .article-item, .jeg_pl_md_box, .content-wrapper .item');
            // If empty, brute force search for article links in main area. 
            // PeaceFM links start with /pages/ or /article/
            if (candidates.length === 0) {
                candidates = $('a[href^="/article/"], a[href*="/pages/news/"], a[href*="/pages/sports/"], a[href*="/pages/business/"]');
            }
            candidates.slice(0, 10).each((_, el)=>{
                let a = $(el).is('a') ? $(el) : $(el).find('a').first();
                const titleLink = $(el).find('.jeg_post_title a, h2 a, h3 a').first();
                if (titleLink.length) a = titleLink;
                const link = a.attr('href');
                let title = a.text().trim();
                // Image
                let image = $(el).find('img').attr('data-src') || $(el).find('img').attr('src');
                if (!image) {
                    image = $(el).closest('div, li').find('img').first().attr('src');
                }
                // Extract publication date - PeaceFM typically has date in .jeg_meta_date or time elements
                let dateStr = $(el).find('.jeg_meta_date, .date, time, .published, .post-date').first().text().trim();
                if (!dateStr) {
                    dateStr = $(el).find('time').attr('datetime') || '';
                }
                const { timestamp, display } = parsePublicationDate(dateStr);
                // Filter out non-article links if brute forcing (basic heuristic)
                // PeaceFM usually contains 'pages' or 'article'
                if (link && (link.includes('/article/') || link.includes('/pages/')) && title && title.length > 10) {
                    const fullLink = resolveUrl('https://www.peacefmonline.com', link);
                    if (seenLinks.has(fullLink)) return;
                    seenLinks.add(fullLink);
                    if (image) image = resolveUrl('https://www.peacefmonline.com', image);
                    stories.push({
                        id: `peace-${stories.length + Math.random()}`,
                        source: 'PeaceFM',
                        title,
                        link: fullLink,
                        image: image || null,
                        time: display,
                        timestamp,
                        section: sec.name
                    });
                }
            });
        } catch (e) {
            console.error(`PeaceFM ${sec.name} Error:`, e);
        }
    }));
    return stories;
}
// ---------------------------------------------------------------------------
// Source: MyJoyOnline (HTML Scrape Sections)
// ---------------------------------------------------------------------------
async function scrapeMyJoyOnline() {
    const sections = [
        {
            name: 'News',
            url: 'https://www.myjoyonline.com/news/'
        },
        {
            name: 'Sports',
            url: 'https://www.myjoyonline.com/sports/'
        },
        {
            name: 'Business',
            url: 'https://www.myjoyonline.com/business/'
        }
    ];
    const stories = [];
    const seenLinks = new Set();
    await Promise.all(sections.map(async (sec)=>{
        try {
            const res = await fetch(sec.url, {
                headers: {
                    'User-Agent': 'Mozilla/5.0'
                }
            });
            const html = await res.text();
            const $ = __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"](html);
            // Structure: divs containing .bgposition (image link) and .title (text link)
            // or just iterate .col-xs-6, .col-lg-3 containers
            const containers = $('.news-main-list .col-lg-3, .col-lg-6, .home-section-story-list li, .main-listing-article');
            containers.slice(0, 10).each((_, el)=>{
                const imgLink = $(el).find('a.bgposition');
                const titleLink = $(el).find('h3 a, h4 a, .title a').first();
                const fallbackLink = $(el).find('a').first();
                const finalLink = titleLink.length ? titleLink : imgLink.length ? imgLink : fallbackLink;
                const link = finalLink.attr('href');
                let title = finalLink.text().trim();
                // If title was empty from link, try finding header text
                if (!title) title = $(el).find('h1, h2, h3, h4').text().trim();
                let image = $(el).find('img').attr('data-src') || $(el).find('img').attr('src');
                // Extract from style if bgposition
                if (!image && imgLink.attr('style')) {
                    const match = imgLink.attr('style')?.match(/url\(['"]?([^'"]+)['"]?\)/);
                    if (match) image = match[1];
                }
                // Extract publication date - MyJoyOnline typically has date in .date, time, or .post-date
                let dateStr = $(el).find('.date, time, .post-date, .published, .entry-date').first().text().trim();
                if (!dateStr) {
                    dateStr = $(el).find('time').attr('datetime') || '';
                }
                const { timestamp, display } = parsePublicationDate(dateStr);
                if (link && title && title.length > 10) {
                    const fullLink = resolveUrl('https://www.myjoyonline.com', link);
                    if (seenLinks.has(fullLink)) return;
                    seenLinks.add(fullLink);
                    stories.push({
                        id: `joy-${stories.length + Math.random()}`,
                        source: 'MyJoyOnline',
                        title,
                        link: fullLink,
                        image: image || null,
                        time: display,
                        timestamp,
                        section: sec.name
                    });
                }
            });
        } catch (e) {
            console.error(`MyJoyOnline ${sec.name} Error:`, e);
        }
    }));
    return stories;
}
async function GET() {
    const [ghanaStories, adomStories, peaceStories, joyStories] = await Promise.all([
        scrapeGhanaWeb(),
        scrapeAdomOnline(),
        scrapePeaceFM(),
        scrapeMyJoyOnline()
    ]);
    let allStories = [
        ...ghanaStories,
        ...adomStories,
        ...peaceStories,
        ...joyStories
    ];
    // Deduplicate by link
    const uniqueMap = new Map();
    allStories.forEach((s)=>uniqueMap.set(s.link, s));
    allStories = Array.from(uniqueMap.values());
    // sort
    allStories.sort((a, b)=>b.timestamp - a.timestamp);
    // Deep Fetch Missing Images (Limit 15 total to preserve speed)
    // Deep Fetch Metadata for items missing reliable date/image
    const storiesToUpdate = allStories.filter((s)=>s.time === 'Recent' || !s.image);
    // Process a limited batch (top 30) to preserve speed
    const batch = storiesToUpdate.slice(0, 30);
    await Promise.all(batch.map(async (story)=>{
        const metadata = await fetchArticleMetadata(story.link);
        if (metadata.timestamp && metadata.time) {
            story.timestamp = metadata.timestamp;
            story.time = metadata.time;
        }
        if (!story.image && metadata.image) {
            story.image = metadata.image;
        }
    }));
    // Final Sort by timestamp descending (newest first)
    allStories.sort((a, b)=>b.timestamp - a.timestamp);
    // Remove timestamp field from output (keep only the display time)
    const storiesOutput = allStories.map(({ timestamp, ...story })=>story);
    const data = {
        generated_at: new Date().toISOString(),
        count: storiesOutput.length,
        stories: storiesOutput
    };
    try {
        const publicDir = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(process.cwd(), 'public');
        if (!__TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].existsSync(publicDir)) __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].mkdirSync(publicDir);
        __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].writeFileSync(__TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(publicDir, 'news-feed.json'), JSON.stringify(data, null, 2));
    } catch (err) {
        console.error('Failed to save content JSON:', err);
    }
    return __TURBOPACK__imported__module__$5b$project$5d2f$news$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__4b501281._.js.map