{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/oscar/news/src/app/api/news/route.ts"],"sourcesContent":["\r\nimport { NextResponse } from 'next/server';\r\nimport * as cheerio from 'cheerio';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\ninterface Story {\r\n    id: string;\r\n    source: string;\r\n    title: string;\r\n    link: string;\r\n    image: string | null;\r\n    time: string;\r\n    timestamp: number;\r\n    section?: string;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Helpers\r\n// ---------------------------------------------------------------------------\r\n\r\nfunction normalizeTitle(title: string): string {\r\n    return title.toLowerCase().replace(/[^a-z0-9]/g, '');\r\n}\r\n\r\nfunction resolveUrl(base: string, relative: string): string {\r\n    try {\r\n        return new URL(relative, base).href;\r\n    } catch {\r\n        return relative;\r\n    }\r\n}\r\n\r\n// Parse publication date from various formats\r\nfunction parsePublicationDate(dateStr: string): { timestamp: number; display: string } {\r\n    if (!dateStr || dateStr.trim() === '') {\r\n        return { timestamp: Date.now(), display: 'Recent' };\r\n    }\r\n\r\n    const cleaned = dateStr.trim();\r\n    const d = new Date(cleaned);\r\n\r\n    if (!isNaN(d.getTime())) {\r\n        const timestamp = d.getTime();\r\n        const display = d.toLocaleString('en-US', {\r\n            hour: 'numeric',\r\n            minute: '2-digit',\r\n            month: 'short',\r\n            day: 'numeric'\r\n        });\r\n        return { timestamp, display };\r\n    }\r\n\r\n    // If we can't parse it, return current time\r\n    return { timestamp: Date.now(), display: 'Recent' };\r\n}\r\n\r\n// Fallback: Fetch article page to find og:image\r\n// Fallback: Fetch article page to find og:image and parsing date\r\nasync function fetchArticleMetadata(link: string): Promise<{ image: string | null, timestamp?: number, time?: string }> {\r\n    try {\r\n        const res = await fetch(link, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n        if (!res.ok) return { image: null };\r\n        const html = await res.text();\r\n        const $ = cheerio.load(html);\r\n\r\n        // Image\r\n        const image = $('meta[property=\"og:image\"]').attr('content') ||\r\n            $('meta[name=\"twitter:image\"]').attr('content') ||\r\n            null;\r\n\r\n        // Date\r\n        let dateStr = $('meta[property=\"og:article:published_time\"]').attr('content') ||\r\n            $('meta[property=\"article:published_time\"]').attr('content') ||\r\n            $('meta[name=\"article:published_time\"]').attr('content') ||\r\n            $('meta[itemprop=\"datePublished\"]').attr('content') ||\r\n            $('meta[name=\"pubdate\"]').attr('content') ||\r\n            $('#date').text() ||\r\n            $('time').first().attr('datetime');\r\n\r\n        let timestamp: number | undefined;\r\n        let time: string | undefined;\r\n\r\n        if (dateStr) {\r\n            const parsed = parsePublicationDate(dateStr);\r\n            if (parsed.display !== 'Recent') {\r\n                timestamp = parsed.timestamp;\r\n                time = parsed.display;\r\n            }\r\n        }\r\n\r\n        return { image, timestamp, time };\r\n    } catch {\r\n        return { image: null };\r\n    }\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: GhanaWeb (Scrape Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeGhanaWeb(): Promise<Story[]> {\r\n    const sections = [\r\n        { name: 'News', url: 'https://www.ghanaweb.com/GhanaHomePage/NewsArchive/' },\r\n        { name: 'Sports', url: 'https://www.ghanaweb.com/GhanaHomePage/SportsArchive/' },\r\n        { name: 'Business', url: 'https://www.ghanaweb.com/GhanaHomePage/business/' }\r\n    ];\r\n\r\n    const stories: Story[] = [];\r\n    const seenLinks = new Set<string>();\r\n\r\n    await Promise.all(sections.map(async (sec) => {\r\n        try {\r\n            const res = await fetch(sec.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n            const html = await res.text();\r\n            const $ = cheerio.load(html);\r\n\r\n            // Strategy: \r\n            // 1. Try known containers (desktop view)\r\n            // 2. Fallback: Find ALL links that look like articles in this section\r\n            let candidates = $('.inner-lead, .sub-menu-list__news li, .news_listing .inner, #leads .inner, .news-list li');\r\n\r\n            if (candidates.length === 0) {\r\n                // Fallback: finding any link containing 'Article' or looking like a news path\r\n                // GhanaWeb articles: /GhanaHomePage/NewsArchive/artikel.php?ID=... or similar slugs\r\n                candidates = $('a[href*=\"artikel.php\"], a[href*=\"/NewsArchive/\"], a[href*=\"/SportsArchive/\"], a[href*=\"/business/\"]');\r\n            }\r\n\r\n            candidates.slice(0, 10).each((_, el) => {\r\n                const a = $(el).is('a') ? $(el) : $(el).find('a').first();\r\n                const link = a.attr('href');\r\n                let title = a.attr('title') || a.text().trim();\r\n\r\n                if (!title || title.length < 5) {\r\n                    title = $(el).find('h2, h3, h4, p').text().trim();\r\n                }\r\n\r\n                let image = $(el).find('img').attr('src');\r\n                if (!image) {\r\n                    // Check parent for image\r\n                    image = $(el).closest('div, li').find('img').attr('src');\r\n                }\r\n\r\n                // Extract publication date - GhanaWeb typically has date in .date, .time, or time elements\r\n                let dateStr = $(el).find('.date, .time, time, .published, .post-date').first().text().trim();\r\n                if (!dateStr) {\r\n                    // Check for datetime attribute in time element\r\n                    dateStr = $(el).find('time').attr('datetime') || '';\r\n                }\r\n                const { timestamp, display } = parsePublicationDate(dateStr);\r\n\r\n                if (link && title && title.length > 10 && !link.includes('javascript') && !link.includes('#')) {\r\n                    const fullLink = resolveUrl('https://www.ghanaweb.com', link);\r\n                    if (seenLinks.has(fullLink)) return;\r\n                    seenLinks.add(fullLink);\r\n\r\n                    if (image) image = resolveUrl('https://cdn.ghanaweb.com', image);\r\n\r\n                    stories.push({\r\n                        id: `gw-${stories.length + Math.random()}`,\r\n                        source: 'GhanaWeb',\r\n                        title,\r\n                        link: fullLink,\r\n                        image: image || null,\r\n                        time: display,\r\n                        timestamp,\r\n                        section: sec.name\r\n                    });\r\n                }\r\n            });\r\n        } catch (e) {\r\n            console.error(`GhanaWeb ${sec.name} Error:`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: AdomOnline (RSS Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeAdomOnline(): Promise<Story[]> {\r\n    const feeds = [\r\n        { name: 'News', url: 'https://www.adomonline.com/category/news/feed/' },\r\n        { name: 'Sports', url: 'https://www.adomonline.com/category/sports/feed/' },\r\n        { name: 'Business', url: 'https://www.adomonline.com/category/business/feed/' }\r\n    ];\r\n\r\n    const stories: Story[] = [];\r\n    const seenLinks = new Set<string>();\r\n\r\n    await Promise.all(feeds.map(async (feed) => {\r\n        try {\r\n            const res = await fetch(feed.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n            const xml = await res.text();\r\n            const $ = cheerio.load(xml, { xmlMode: true });\r\n\r\n            $('item').slice(0, 5).each((_, el) => {\r\n                const title = $(el).find('title').text().trim();\r\n                const link = $(el).find('link').text().trim();\r\n                const pubDate = $(el).find('pubDate').text().trim();\r\n\r\n                if (seenLinks.has(link)) return;\r\n                seenLinks.add(link);\r\n\r\n                let timestamp = Date.now();\r\n                let timeDisplay = 'Recent';\r\n                if (pubDate) {\r\n                    const d = new Date(pubDate);\r\n                    if (!isNaN(d.getTime())) {\r\n                        timestamp = d.getTime();\r\n                        timeDisplay = d.toLocaleString('en-US', { hour: 'numeric', minute: '2-digit', month: 'short', day: 'numeric' });\r\n                    }\r\n                }\r\n\r\n                let image = $(el).find('media\\\\:content').attr('url') ||\r\n                    $(el).find('media\\\\:thumbnail').attr('url');\r\n\r\n                if (!image) {\r\n                    const content = $(el).find('content\\\\:encoded').text();\r\n                    const match = content.match(/src=\"([^\"]+)\"/);\r\n                    if (match) image = match[1];\r\n                }\r\n\r\n                stories.push({\r\n                    id: `adom-${stories.length + Math.random()}`,\r\n                    source: 'AdomOnline',\r\n                    title,\r\n                    link,\r\n                    image: image || null,\r\n                    time: timeDisplay,\r\n                    timestamp,\r\n                    section: feed.name\r\n                });\r\n            });\r\n        } catch (e) {\r\n            console.error(`AdomOnline ${feed.name} Error:`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: PeaceFM (HTML Scrape Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapePeaceFM(): Promise<Story[]> {\r\n    const sections = [\r\n        { name: 'News', url: 'https://www.peacefmonline.com/pages/local/' },\r\n        { name: 'Sports', url: 'https://www.peacefmonline.com/pages/sports/' },\r\n        { name: 'Business', url: 'https://www.peacefmonline.com/pages/business/' }\r\n    ];\r\n\r\n    const stories: Story[] = [];\r\n    const seenLinks = new Set<string>();\r\n\r\n    await Promise.all(sections.map(async (sec) => {\r\n        try {\r\n            const res = await fetch(sec.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n            const html = await res.text();\r\n            const $ = cheerio.load(html);\r\n\r\n            // Try generic containers\r\n            let candidates = $('.jeg_post, .post-item, .article-item, .jeg_pl_md_box, .content-wrapper .item');\r\n\r\n            // If empty, brute force search for article links in main area. \r\n            // PeaceFM links start with /pages/ or /article/\r\n            if (candidates.length === 0) {\r\n                candidates = $('a[href^=\"/article/\"], a[href*=\"/pages/news/\"], a[href*=\"/pages/sports/\"], a[href*=\"/pages/business/\"]');\r\n            }\r\n\r\n            candidates.slice(0, 10).each((_, el) => {\r\n                let a = $(el).is('a') ? $(el) : $(el).find('a').first();\r\n                const titleLink = $(el).find('.jeg_post_title a, h2 a, h3 a').first();\r\n                if (titleLink.length) a = titleLink;\r\n\r\n                const link = a.attr('href');\r\n                let title = a.text().trim();\r\n\r\n                // Image\r\n                let image = $(el).find('img').attr('data-src') || $(el).find('img').attr('src');\r\n                if (!image) {\r\n                    image = $(el).closest('div, li').find('img').first().attr('src');\r\n                }\r\n\r\n                // Extract publication date - PeaceFM typically has date in .jeg_meta_date or time elements\r\n                let dateStr = $(el).find('.jeg_meta_date, .date, time, .published, .post-date').first().text().trim();\r\n                if (!dateStr) {\r\n                    dateStr = $(el).find('time').attr('datetime') || '';\r\n                }\r\n                const { timestamp, display } = parsePublicationDate(dateStr);\r\n\r\n                // Filter out non-article links if brute forcing (basic heuristic)\r\n                // PeaceFM usually contains 'pages' or 'article'\r\n                if (link && (link.includes('/article/') || link.includes('/pages/')) && title && title.length > 10) {\r\n                    const fullLink = resolveUrl('https://www.peacefmonline.com', link);\r\n                    if (seenLinks.has(fullLink)) return;\r\n                    seenLinks.add(fullLink);\r\n\r\n                    if (image) image = resolveUrl('https://www.peacefmonline.com', image);\r\n\r\n                    stories.push({\r\n                        id: `peace-${stories.length + Math.random()}`,\r\n                        source: 'PeaceFM',\r\n                        title,\r\n                        link: fullLink,\r\n                        image: image || null,\r\n                        time: display,\r\n                        timestamp,\r\n                        section: sec.name\r\n                    });\r\n                }\r\n            });\r\n        } catch (e) {\r\n            console.error(`PeaceFM ${sec.name} Error:`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: MyJoyOnline (HTML Scrape Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeMyJoyOnline(): Promise<Story[]> {\r\n    const sections = [\r\n        { name: 'News', url: 'https://www.myjoyonline.com/news/' },\r\n        { name: 'Sports', url: 'https://www.myjoyonline.com/sports/' },\r\n        { name: 'Business', url: 'https://www.myjoyonline.com/business/' }\r\n    ];\r\n\r\n    const stories: Story[] = [];\r\n    const seenLinks = new Set<string>();\r\n\r\n    await Promise.all(sections.map(async (sec) => {\r\n        try {\r\n            const res = await fetch(sec.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n            const html = await res.text();\r\n            const $ = cheerio.load(html);\r\n\r\n            // Structure: divs containing .bgposition (image link) and .title (text link)\r\n            // or just iterate .col-xs-6, .col-lg-3 containers\r\n            const containers = $('.news-main-list .col-lg-3, .col-lg-6, .home-section-story-list li, .main-listing-article');\r\n\r\n            containers.slice(0, 10).each((_, el) => {\r\n                const imgLink = $(el).find('a.bgposition');\r\n                const titleLink = $(el).find('h3 a, h4 a, .title a').first();\r\n                const fallbackLink = $(el).find('a').first();\r\n\r\n                const finalLink = titleLink.length ? titleLink : (imgLink.length ? imgLink : fallbackLink);\r\n\r\n                const link = finalLink.attr('href');\r\n                let title = finalLink.text().trim();\r\n                // If title was empty from link, try finding header text\r\n                if (!title) title = $(el).find('h1, h2, h3, h4').text().trim();\r\n\r\n                let image = $(el).find('img').attr('data-src') || $(el).find('img').attr('src');\r\n                // Extract from style if bgposition\r\n                if (!image && imgLink.attr('style')) {\r\n                    const match = imgLink.attr('style')?.match(/url\\(['\"]?([^'\"]+)['\"]?\\)/);\r\n                    if (match) image = match[1];\r\n                }\r\n\r\n                // Extract publication date - MyJoyOnline typically has date in .date, time, or .post-date\r\n                let dateStr = $(el).find('.date, time, .post-date, .published, .entry-date').first().text().trim();\r\n                if (!dateStr) {\r\n                    dateStr = $(el).find('time').attr('datetime') || '';\r\n                }\r\n                const { timestamp, display } = parsePublicationDate(dateStr);\r\n\r\n                if (link && title && title.length > 10) {\r\n                    const fullLink = resolveUrl('https://www.myjoyonline.com', link);\r\n                    if (seenLinks.has(fullLink)) return;\r\n                    seenLinks.add(fullLink);\r\n\r\n                    stories.push({\r\n                        id: `joy-${stories.length + Math.random()}`,\r\n                        source: 'MyJoyOnline',\r\n                        title,\r\n                        link: fullLink,\r\n                        image: image || null,\r\n                        time: display,\r\n                        timestamp,\r\n                        section: sec.name\r\n                    });\r\n                }\r\n            });\r\n        } catch (e) {\r\n            console.error(`MyJoyOnline ${sec.name} Error:`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Main Handler\r\n// ---------------------------------------------------------------------------\r\n\r\nexport async function GET() {\r\n    const [ghanaStories, adomStories, peaceStories, joyStories] = await Promise.all([\r\n        scrapeGhanaWeb(),\r\n        scrapeAdomOnline(),\r\n        scrapePeaceFM(),\r\n        scrapeMyJoyOnline()\r\n    ]);\r\n\r\n    let allStories = [...ghanaStories, ...adomStories, ...peaceStories, ...joyStories];\r\n\r\n    // Deduplicate by link\r\n    const uniqueMap = new Map();\r\n    allStories.forEach(s => uniqueMap.set(s.link, s));\r\n    allStories = Array.from(uniqueMap.values());\r\n\r\n    // sort\r\n    allStories.sort((a, b) => b.timestamp - a.timestamp);\r\n\r\n    // Deep Fetch Missing Images (Limit 15 total to preserve speed)\r\n    // Deep Fetch Metadata for items missing reliable date/image\r\n    const storiesToUpdate = allStories.filter(s => s.time === 'Recent' || !s.image);\r\n\r\n    // Process a limited batch (top 30) to preserve speed\r\n    const batch = storiesToUpdate.slice(0, 30);\r\n\r\n    await Promise.all(batch.map(async (story) => {\r\n        const metadata = await fetchArticleMetadata(story.link);\r\n        if (metadata.timestamp && metadata.time) {\r\n            story.timestamp = metadata.timestamp;\r\n            story.time = metadata.time;\r\n        }\r\n        if (!story.image && metadata.image) {\r\n            story.image = metadata.image;\r\n        }\r\n    }));\r\n\r\n    // Final Sort by timestamp descending (newest first)\r\n    allStories.sort((a, b) => b.timestamp - a.timestamp);\r\n\r\n    // Remove timestamp field from output (keep only the display time)\r\n    const storiesOutput = allStories.map(({ timestamp, ...story }) => story);\r\n\r\n    const data = {\r\n        generated_at: new Date().toISOString(),\r\n        count: storiesOutput.length,\r\n        stories: storiesOutput\r\n    };\r\n\r\n    try {\r\n        const publicDir = path.join(process.cwd(), 'public');\r\n        if (!fs.existsSync(publicDir)) fs.mkdirSync(publicDir);\r\n        fs.writeFileSync(path.join(publicDir, 'news-feed.json'), JSON.stringify(data, null, 2));\r\n    } catch (err) {\r\n        console.error('Failed to save content JSON:', err);\r\n    }\r\n\r\n    return NextResponse.json(data);\r\n}\r\n"],"names":[],"mappings":"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"}}]
}