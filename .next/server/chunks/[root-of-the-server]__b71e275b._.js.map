{"version":3,"sources":["../../../../news/src/lib/db.ts","../../../../news/src/pages/api/news.ts","../../../../news/node_modules/next/src/build/templates/pages-api.ts"],"sourcesContent":["import { createClient } from '@libsql/client';\r\n\r\nconst url = process.env.TURSO_DATABASE_URL || 'file:news.db';\r\nconst authToken = process.env.TURSO_AUTH_TOKEN;\r\n\r\nexport const db = createClient({\r\n  url,\r\n  authToken,\r\n});\r\n\r\n// Initialize database (Async wrapper needed or call this explicitly if needed, \r\n// using top-level await if environment supports it, but simpler to invoke lazily or just ensure it exists.)\r\n// For simplicity in Next.js Serverless, we can attempt to init on load or just cache the promise.\r\n// Actually, pure SQL CREATE TABLE IF NOT EXISTS is cheap.\r\n\r\nasync function initDb() {\r\n  await db.execute(`\r\n    CREATE TABLE IF NOT EXISTS articles (\r\n      id TEXT PRIMARY KEY,\r\n      source TEXT NOT NULL,\r\n      title TEXT NOT NULL,\r\n      link TEXT UNIQUE NOT NULL,\r\n      image TEXT,\r\n      time TEXT NOT NULL,\r\n      section TEXT NOT NULL,\r\n      timestamp INTEGER NOT NULL,\r\n      created_at INTEGER NOT NULL,\r\n      content TEXT\r\n    )\r\n  `);\r\n}\r\n\r\n// We can just run this. in a serverless env it might run multiple times but it's safe.\r\n// Ideally we'd await this before other ops.\r\ninitDb().catch(console.error);\r\n\r\n\r\nexport interface Article {\r\n  id: string;\r\n  source: string;\r\n  title: string;\r\n  link: string;\r\n  image: string | null;\r\n  time: string;\r\n  section: string;\r\n  timestamp: number;\r\n  created_at?: number;\r\n  content?: string;\r\n}\r\n\r\nexport async function insertArticles(articles: Article[]): Promise<number> {\r\n  if (articles.length === 0) return 0;\r\n\r\n  let count = 0;\r\n\r\n  // We process individually to ensure one bad egg (duplicate ID) doesn't spoil the bunch\r\n  for (const article of articles) {\r\n    try {\r\n      await db.execute({\r\n        sql: `\r\n          INSERT INTO articles (id, source, title, link, image, time, section, timestamp, created_at, content)\r\n          VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\r\n          ON CONFLICT(link) DO UPDATE SET\r\n            time = excluded.time,\r\n            timestamp = excluded.timestamp,\r\n            image = excluded.image,\r\n            title = excluded.title,\r\n            content = CASE WHEN excluded.content IS NOT NULL THEN excluded.content ELSE articles.content END\r\n        `,\r\n        args: [\r\n          article.id,\r\n          article.source,\r\n          article.title,\r\n          article.link,\r\n          article.image,\r\n          article.time,\r\n          article.section,\r\n          article.timestamp,\r\n          Date.now(),\r\n          article.content || null\r\n        ]\r\n      });\r\n      count++;\r\n    } catch (err: any) {\r\n      if (err.code === 'SQLITE_CONSTRAINT') {\r\n        console.warn(`[DB] Skipped duplicate/conflict for ${article.title} (${article.id}):`, err.message);\r\n      } else {\r\n        console.error(`[DB] Error inserting ${article.title}:`, err);\r\n      }\r\n    }\r\n  }\r\n\r\n  return count;\r\n}\r\n\r\nexport async function getAllArticles(limit: number = 500, includeContent: boolean = false): Promise<Article[]> {\r\n  const rs = await db.execute({\r\n    sql: `\r\n      SELECT id, source, title, link, image, time, section, timestamp${includeContent ? ', content' : ''}\r\n      FROM articles\r\n      ORDER BY timestamp DESC\r\n      LIMIT ?\r\n    `,\r\n    args: [limit]\r\n  });\r\n\r\n  // rs.rows is correct\r\n  return rs.rows as unknown as Article[];\r\n}\r\n\r\nexport async function getArticlesSince(\r\n  sinceTimestamp: number,\r\n  limit: number = 500,\r\n  includeContent: boolean = false\r\n): Promise<Article[]> {\r\n  const rs = await db.execute({\r\n    sql: `\r\n      SELECT id, source, title, link, image, time, section, timestamp${includeContent ? ', content' : ''}\r\n      FROM articles\r\n      WHERE timestamp > ?\r\n      ORDER BY timestamp DESC\r\n      LIMIT ?\r\n    `,\r\n    args: [sinceTimestamp, limit]\r\n  });\r\n\r\n  return rs.rows as unknown as Article[];\r\n}\r\n\r\nexport async function getArticleCount(): Promise<number> {\r\n  const rs = await db.execute('SELECT COUNT(*) as count FROM articles');\r\n  return Number(rs.rows[0].count);\r\n}\r\n\r\nexport async function getAllLinks(): Promise<Set<string>> {\r\n  const rs = await db.execute('SELECT link FROM articles');\r\n  const links = new Set<string>();\r\n  for (const row of rs.rows) {\r\n    if (typeof row.link === 'string') {\r\n      links.add(row.link);\r\n    }\r\n  }\r\n  return links;\r\n}\r\n\r\nexport async function getLatestTimestampsBySource(): Promise<Map<string, number>> {\r\n  const rs = await db.execute('SELECT source, MAX(timestamp) as max_time FROM articles GROUP BY source');\r\n  const map = new Map<string, number>();\r\n  for (const row of rs.rows) {\r\n    if (typeof row.source === 'string' && typeof row.max_time === 'number') {\r\n      map.set(row.source, row.max_time);\r\n    }\r\n  }\r\n  return map;\r\n}\r\n\r\n\r\nexport async function deleteOldArticles(limit: number): Promise<number> {\r\n  // SQLite doesn't support DELETE ... LIMIT directly in all versions, \r\n  // but simpler: DELETE WHERE id NOT IN (SELECT id ... LIMIT ?)\r\n  const rs = await db.execute({\r\n    sql: `\r\n      DELETE FROM articles \r\n      WHERE id NOT IN (\r\n        SELECT id FROM articles \r\n        ORDER BY timestamp DESC \r\n        LIMIT ?\r\n      )\r\n    `,\r\n    args: [limit]\r\n  });\r\n  return rs.rowsAffected;\r\n}\r\n\r\nexport async function deleteInvalidArticles(): Promise<number> {\r\n  const unwantedTitlePatterns = [\r\n    'Home - News', 'Home - Business', 'Home - Sports', 'Home-Business',\r\n    'Business archive', 'News Archive', 'Sports Archive', 'Photo Archives',\r\n    'Archive', 'Category:', 'Section:', 'More News', 'More Stories',\r\n    'View All', 'Latest News', 'Top Stories', 'Click here', 'Read more',\r\n    'TWI News', 'News Videos', 'GhanaWeb TV', '| TV',\r\n    'Year In Review', 'Players Abroad', 'National Team(s)',\r\n    'Stock Exchange', 'Exchange Rate', '(GSE)'\r\n  ];\r\n\r\n  let count = 0;\r\n  try {\r\n    // REMOVED: Deletion of articles without images\r\n    // This was causing valid articles from feeds like ZionFelix, YFM Ghana to be deleted\r\n    // Only delete SVG images which are usually logos/icons, not article images\r\n    const badImageResult = await db.execute(`\r\n      DELETE FROM articles \r\n      WHERE image LIKE '%.svg%'\r\n         OR image LIKE '%.svg?%'\r\n    `);\r\n    count += badImageResult.rowsAffected;\r\n\r\n    // Construct OR conditions for titles\r\n    if (unwantedTitlePatterns.length > 0) {\r\n      const conditions = unwantedTitlePatterns.map(() => `title LIKE ?`).join(' OR ');\r\n      const args = unwantedTitlePatterns.map(p => `%${p}%`);\r\n\r\n      const badTitleResult = await db.execute({\r\n        sql: `DELETE FROM articles WHERE ${conditions}`,\r\n        args: args\r\n      });\r\n      count += badTitleResult.rowsAffected;\r\n    }\r\n\r\n  } catch (err) {\r\n    console.error('Error deleting invalid articles:', err);\r\n  }\r\n  return count;\r\n}\r\n","import type { NextApiRequest, NextApiResponse } from 'next';\r\nimport { getAllArticles, getArticlesSince, getArticleCount } from '../../lib/db';\r\nimport zlib from 'zlib';\r\nimport { promisify } from 'util';\r\n\r\nconst gzip = promisify(zlib.gzip);\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n    // Get parameters from query\r\n    const { limit: limitParam, content: contentParam, since: sinceParam } = req.query;\r\n    // Default to 50 (was 1000) to save massive bandwidth for Android app\r\n    const limit = limitParam ? parseInt(limitParam as string) : 50;\r\n\r\n    // Default to true for backward compatibility with Android app\r\n    const includeContent = contentParam !== 'false';\r\n\r\n    // Parse 'since' timestamp for incremental sync\r\n    const since = sinceParam ? parseInt(sinceParam as string) : null;\r\n\r\n    try {\r\n        let allStories;\r\n\r\n        if (since && !isNaN(since)) {\r\n            // Incremental sync: fetch only articles newer than 'since' timestamp\r\n            allStories = await getArticlesSince(since, limit, includeContent);\r\n        } else {\r\n            // Full fetch: existing behavior\r\n            allStories = await getAllArticles(limit, includeContent);\r\n        }\r\n\r\n        const total = await getArticleCount();\r\n\r\n        // Filter out GhanaWeb articles (REMOVED: User requested to show them again)\r\n        const stories = allStories;\r\n\r\n        // Dynamic caching strategy based on time of day (GMT) and request type\r\n        // Incremental sync requests: Cache for 5 minutes (300s) - more time-sensitive\r\n        // 10 PM to 5 AM (Overnight): Cache for 1 hour (3600s)\r\n        // 5 AM to 10 PM (Daytime): Cache for 20 minutes (1200s)\r\n        const currentHour = new Date().getUTCHours();\r\n        const isOffPeak = currentHour >= 22 || currentHour < 5;\r\n        const cacheTime = since ? 300 : (isOffPeak ? 3600 : 330);\r\n\r\n        res.setHeader('Cache-Control', `s-maxage=${cacheTime}, stale-while-revalidate=60`);\r\n\r\n        const responseData = {\r\n            stories,\r\n            count: stories.length,\r\n            total_in_database: total,\r\n            new_articles_added: 0\r\n        };\r\n\r\n        // Gzip compression for Fast Origin Transfer optimization\r\n        try {\r\n            const jsonBuffer = Buffer.from(JSON.stringify(responseData));\r\n            const compressed = await gzip(jsonBuffer);\r\n\r\n            res.setHeader('Content-Encoding', 'gzip');\r\n            res.setHeader('Content-Type', 'application/json');\r\n            res.status(200).send(compressed);\r\n        } catch (compressionError) {\r\n            console.error('Compression failed, sending uncompressed:', compressionError);\r\n            res.status(200).json(responseData);\r\n        }\r\n    } catch (e) {\r\n        console.error('Error fetching news:', e);\r\n        res.status(500).json({ error: 'Failed to fetch news' });\r\n    }\r\n}\r\n","import type { NextApiResponse } from '../../types'\nimport type { IncomingMessage, ServerResponse } from 'node:http'\n\nimport { sendError } from '../../server/api-utils'\nimport { RouteKind } from '../../server/route-kind'\nimport type { Span } from '../../server/lib/trace/tracer'\nimport { PagesAPIRouteModule } from '../../server/route-modules/pages-api/module.compiled'\n\nimport { hoist } from './helpers'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getTracer, SpanKind } from '../../server/lib/trace/tracer'\nimport { BaseServerSpan } from '../../server/lib/trace/constants'\nimport type { InstrumentationOnRequestError } from '../../server/instrumentation/types'\nimport { addRequestMeta } from '../../server/request-meta'\n\n// Re-export the handler (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export config.\nexport const config = hoist(userland, 'config')\n\n// Create and export the route module that will be consumed.\nconst routeModule = new PagesAPIRouteModule({\n  definition: {\n    kind: RouteKind.PAGES_API,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  userland,\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n})\n\nexport async function handler(\n  req: IncomingMessage,\n  res: ServerResponse,\n  ctx: {\n    waitUntil?: (prom: Promise<void>) => void\n  }\n): Promise<void> {\n  if (routeModule.isDev) {\n    addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint())\n  }\n  let srcPage = 'VAR_DEFINITION_PAGE'\n\n  // turbopack doesn't normalize `/index` in the page name\n  // so we need to to process dynamic routes properly\n  // TODO: fix turbopack providing differing value from webpack\n  if (process.env.TURBOPACK) {\n    srcPage = srcPage.replace(/\\/index$/, '') || '/'\n  }\n\n  const prepareResult = await routeModule.prepare(req, res, { srcPage })\n\n  if (!prepareResult) {\n    res.statusCode = 400\n    res.end('Bad Request')\n    ctx.waitUntil?.(Promise.resolve())\n    return\n  }\n\n  const { query, params, prerenderManifest, routerServerContext } =\n    prepareResult\n\n  try {\n    const method = req.method || 'GET'\n    const tracer = getTracer()\n\n    const activeSpan = tracer.getActiveScopeSpan()\n    const onRequestError =\n      routeModule.instrumentationOnRequestError.bind(routeModule)\n\n    const invokeRouteModule = async (span?: Span) =>\n      routeModule\n        .render(req, res, {\n          query: {\n            ...query,\n            ...params,\n          },\n          params,\n          allowedRevalidateHeaderKeys: process.env\n            .__NEXT_ALLOWED_REVALIDATE_HEADERS as any as string[],\n          multiZoneDraftMode: Boolean(process.env.__NEXT_MULTI_ZONE_DRAFT_MODE),\n          trustHostHeader: process.env\n            .__NEXT_TRUST_HOST_HEADER as any as boolean,\n          // TODO: get this from from runtime env so manifest\n          // doesn't need to load\n          previewProps: prerenderManifest.preview,\n          propagateError: false,\n          dev: routeModule.isDev,\n          page: 'VAR_DEFINITION_PAGE',\n\n          internalRevalidate: routerServerContext?.revalidate,\n\n          onError: (...args: Parameters<InstrumentationOnRequestError>) =>\n            onRequestError(req, ...args),\n        })\n        .finally(() => {\n          if (!span) return\n\n          span.setAttributes({\n            'http.status_code': res.statusCode,\n            'next.rsc': false,\n          })\n\n          const rootSpanAttributes = tracer.getRootSpanAttributes()\n          // We were unable to get attributes, probably OTEL is not enabled\n          if (!rootSpanAttributes) {\n            return\n          }\n\n          if (\n            rootSpanAttributes.get('next.span_type') !==\n            BaseServerSpan.handleRequest\n          ) {\n            console.warn(\n              `Unexpected root span type '${rootSpanAttributes.get(\n                'next.span_type'\n              )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n            )\n            return\n          }\n\n          const route = rootSpanAttributes.get('next.route')\n          if (route) {\n            const name = `${method} ${route}`\n\n            span.setAttributes({\n              'next.route': route,\n              'http.route': route,\n              'next.span_name': name,\n            })\n            span.updateName(name)\n          } else {\n            span.updateName(`${method} ${srcPage}`)\n          }\n        })\n\n    // TODO: activeSpan code path is for when wrapped by\n    // next-server can be removed when this is no longer used\n    if (activeSpan) {\n      await invokeRouteModule(activeSpan)\n    } else {\n      await tracer.withPropagatedContext(req.headers, () =>\n        tracer.trace(\n          BaseServerSpan.handleRequest,\n          {\n            spanName: `${method} ${srcPage}`,\n            kind: SpanKind.SERVER,\n            attributes: {\n              'http.method': method,\n              'http.target': req.url,\n            },\n          },\n          invokeRouteModule\n        )\n      )\n    }\n  } catch (err) {\n    // we re-throw in dev to show the error overlay\n    if (routeModule.isDev) {\n      throw err\n    }\n    // this is technically an invariant as error handling\n    // should be done inside of api-resolver onError\n    sendError(res as NextApiResponse, 500, 'Internal Server Error')\n  } finally {\n    // We don't allow any waitUntil work in pages API routes currently\n    // so if callback is present return with resolved promise since no\n    // pending work\n    ctx.waitUntil?.(Promise.resolve())\n  }\n}\n"],"names":["sendError","RouteKind","PagesAPIRouteModule","hoist","userland","getTracer","SpanKind","BaseServerSpan","addRequestMeta","config","routeModule","definition","kind","PAGES_API","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","handler","req","res","ctx","isDev","hrtime","bigint","srcPage","TURBOPACK","replace","prepareResult","prepare","statusCode","end","waitUntil","Promise","resolve","query","params","prerenderManifest","routerServerContext","method","tracer","activeSpan","getActiveScopeSpan","onRequestError","instrumentationOnRequestError","bind","invokeRouteModule","span","render","allowedRevalidateHeaderKeys","__NEXT_ALLOWED_REVALIDATE_HEADERS","multiZoneDraftMode","Boolean","__NEXT_MULTI_ZONE_DRAFT_MODE","trustHostHeader","__NEXT_TRUST_HOST_HEADER","previewProps","preview","propagateError","dev","internalRevalidate","revalidate","onError","args","finally","setAttributes","rootSpanAttributes","getRootSpanAttributes","get","handleRequest","console","warn","route","name","updateName","withPropagatedContext","headers","trace","spanName","SERVER","attributes","url","err"],"mappings":"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","ignoreList":[2]}