{"version":3,"sources":["../../../../news/src/lib/rss.ts","../../../../news/src/pages/api/cron.ts","../../../../news/node_modules/next/src/build/templates/pages-api.ts"],"sourcesContent":["import Parser from 'rss-parser';\r\n\r\nexport type NewsItem = {\r\n    title: string;\r\n    link: string;\r\n    pubDate: string;\r\n    content: string;\r\n    contentSnippet: string;\r\n    source: string;\r\n    isoDate?: string;\r\n    imageUrl?: string;\r\n    category?: string;\r\n};\r\n\r\nconst parser = new Parser({\r\n    timeout: 10000,\r\n    headers: {\r\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\r\n    },\r\n    customFields: {\r\n        item: [\r\n            ['media:content', 'mediaContent'],\r\n            ['media:thumbnail', 'mediaThumbnail'],\r\n            ['enclosure', 'enclosure'],\r\n            ['dc:creator', 'creator'],\r\n            ['content:encoded', 'contentEncoded'],\r\n        ],\r\n    },\r\n});\r\n\r\nfunction extractImage(item: any): string | undefined {\r\n    if (item.mediaContent && item.mediaContent.$ && item.mediaContent.$.url) {\r\n        return item.mediaContent.$.url;\r\n    }\r\n    if (item.mediaThumbnail && item.mediaThumbnail.$ && item.mediaThumbnail.$.url) {\r\n        return item.mediaThumbnail.$.url;\r\n    }\r\n    if (item.enclosure && item.enclosure.url) {\r\n        return item.enclosure.url;\r\n    }\r\n    // Fallback: try to find an image tag in content\r\n    const content = item.contentEncoded || item.content || '';\r\n    const imgMatch = content.match(/<img[^>]+src=\"([^\">]+)\"/);\r\n    if (imgMatch) {\r\n        return imgMatch[1];\r\n    }\r\n    return undefined;\r\n}\r\n\r\nexport async function fetchRSS(url: string, sourceName: string, category: string = 'General'): Promise<NewsItem[]> {\r\n    try {\r\n        const feed = await parser.parseURL(url);\r\n        return feed.items.map((item: any) => ({\r\n            title: item.title || 'No Title',\r\n            link: item.link || '#',\r\n            pubDate: item.pubDate || new Date().toISOString(),\r\n            isoDate: item.isoDate,\r\n            content: item.contentEncoded || item.content || item.contentSnippet || '',\r\n            contentSnippet: item.contentSnippet || '',\r\n            source: sourceName,\r\n            category: category,\r\n            imageUrl: extractImage(item),\r\n        }));\r\n    } catch (error) {\r\n        console.error(`Error fetching RSS feed for ${sourceName} (${url}):`, error);\r\n        return [];\r\n    }\r\n}\r\n","\r\nimport type { NextApiRequest, NextApiResponse } from 'next';\r\nimport * as cheerio from 'cheerio';\r\nimport { Readability } from '@mozilla/readability';\r\nimport { JSDOM } from 'jsdom';\r\nimport { insertArticles, deleteOldArticles, deleteInvalidArticles, getAllLinks, Article } from '../../lib/db';\r\nimport { fetchRSS } from '../../lib/rss';\r\n\r\nexport const config = {\r\n    maxDuration: 60, // Serverless function timeout\r\n};\r\n\r\n// ---------------------------------------------------------------------------\r\n// Helpers\r\n// ---------------------------------------------------------------------------\r\n\r\nfunction normalizeTitle(title: string): string {\r\n    return title.toLowerCase().replace(/[^a-z0-9]/g, '');\r\n}\r\n\r\n// Calculate similarity between two titles (0-1 scale)\r\nfunction titleSimilarity(title1: string, title2: string): number {\r\n    const normalize = (s: string) => s.toLowerCase()\r\n        .replace(/[^a-z0-9\\s]/g, '')\r\n        .replace(/\\s+/g, ' ')\r\n        .trim();\r\n\r\n    const t1 = normalize(title1);\r\n    const t2 = normalize(title2);\r\n\r\n    // Quick exact match check\r\n    if (t1 === t2) return 1.0;\r\n\r\n    // Word-based similarity (Jaccard similarity)\r\n    const words1 = new Set(t1.split(' ').filter(w => w.length > 2)); // Ignore short words\r\n    const words2 = new Set(t2.split(' ').filter(w => w.length > 2));\r\n\r\n    if (words1.size === 0 || words2.size === 0) return 0;\r\n\r\n    const intersection = new Set([...words1].filter(w => words2.has(w)));\r\n    const union = new Set([...words1, ...words2]);\r\n\r\n    return intersection.size / union.size;\r\n}\r\n\r\n// Check if a story is a duplicate based on title similarity\r\nfunction isDuplicateStory(newStory: Story, existingStories: Story[], threshold = 0.7): boolean {\r\n    return existingStories.some(existing => {\r\n        const similarity = titleSimilarity(newStory.title, existing.title);\r\n        return similarity >= threshold;\r\n    });\r\n}\r\n\r\nfunction resolveUrl(base: string, relative: string): string {\r\n    try {\r\n        return new URL(relative, base).href;\r\n    } catch {\r\n        return relative;\r\n    }\r\n}\r\n\r\n// Parse publication date from various formats\r\nfunction parsePublicationDate(dateStr: string): { timestamp: number; display: string } {\r\n    if (!dateStr || dateStr.trim() === '') {\r\n        return { timestamp: Date.now(), display: 'Recent' };\r\n    }\r\n\r\n    const cleaned = dateStr.trim();\r\n    const d = new Date(cleaned);\r\n\r\n    if (!isNaN(d.getTime())) {\r\n        const timestamp = d.getTime();\r\n        const display = d.toLocaleString('en-US', {\r\n            hour: 'numeric',\r\n            minute: '2-digit',\r\n            month: 'short',\r\n            day: 'numeric'\r\n        });\r\n        return { timestamp, display };\r\n    }\r\n\r\n    // If we can't parse it, return current time\r\n    return { timestamp: Date.now(), display: 'Recent' };\r\n}\r\n\r\nfunction timeAgo(timestamp: number): string {\r\n    const seconds = Math.floor((Date.now() - timestamp) / 1000);\r\n\r\n    let interval = seconds / 31536000; // years\r\n    if (interval > 1) return Math.floor(interval) + \" years ago\";\r\n    interval = seconds / 2592000; // months\r\n    if (interval > 1) return Math.floor(interval) + \" months ago\";\r\n    interval = seconds / 86400; // days\r\n    if (interval > 1) return Math.floor(interval) + \" days ago\";\r\n    interval = seconds / 3600; // hours\r\n    if (interval > 1) return Math.floor(interval) + \" hours ago\";\r\n    interval = seconds / 60; // minutes\r\n    if (interval > 1) return Math.floor(interval) + \" minutes ago\";\r\n    return Math.floor(seconds) + \" seconds ago\";\r\n}\r\n\r\ninterface Story {\r\n    id: string;\r\n    source: string;\r\n    title: string;\r\n    link: string;\r\n    image: string | null;\r\n    time: string;\r\n    timestamp: number;\r\n    section?: string;\r\n    content?: string;\r\n}\r\n\r\n\r\n// Fallback: Fetch article page to find og:image and parsing date\r\nasync function fetchArticleMetadata(link: string, source?: string): Promise<{ image: string | null, timestamp?: number, time?: string, content?: string }> {\r\n    try {\r\n        // Special handling for PeaceFM API\r\n        if (source === 'PeaceFM' || link.includes('peacefmonline.com')) {\r\n            // Extract ID. format: /.../.../123456-some-slug\r\n            const idMatch = link.match(/\\/(\\d+)-/);\r\n            if (idMatch) {\r\n                const id = idMatch[1];\r\n                const apiUrl = `https://articles-engine.peacefmonline.com/v1/articles/${id}`;\r\n                const res = await fetch(apiUrl, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n                if (res.ok) {\r\n                    const json = await res.json();\r\n                    if (json.status === 'success' && json.data) {\r\n                        const d = json.data;\r\n                        return {\r\n                            image: d.main_photo?.photo_url || null,\r\n                            timestamp: new Date(d.created_at).getTime(),\r\n                            time: timeAgo(new Date(d.created_at).getTime()),\r\n                            content: d.main_description // This is HTML\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        const res = await fetch(link, { headers: { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36' } });\r\n        if (!res.ok) return { image: null };\r\n        const html = await res.text();\r\n        const $ = cheerio.load(html);\r\n\r\n        // Image\r\n        let image = $('meta[property=\"og:image\"]').attr('content') ||\r\n            $('meta[name=\"twitter:image\"]').attr('content') ||\r\n            null;\r\n\r\n        // Date\r\n        let dateStr = $('meta[property=\"og:article:published_time\"]').attr('content') ||\r\n            $('meta[property=\"article:published_time\"]').attr('content') ||\r\n            $('meta[name=\"article:published_time\"]').attr('content') ||\r\n            $('meta[property=\"og:updated_time\"]').attr('content') ||\r\n            $('meta[property=\"article:modified_time\"]').attr('content') ||\r\n            $('meta[itemprop=\"datePublished\"]').attr('content') ||\r\n            $('meta[name=\"pubdate\"]').attr('content') ||\r\n            $('#date').text() ||\r\n            $('time').first().attr('datetime');\r\n\r\n        // MyJoyOnline-specific date extraction\r\n        if (!dateStr && source === 'MyJoyOnline') {\r\n            dateStr = $('.post-date, .entry-date, .published, .article-date').first().text().trim() ||\r\n                $('.meta-info time').text().trim() ||\r\n                $('span[class*=\"date\"]').first().text().trim();\r\n        }\r\n\r\n        // GhanaWeb: Prioritize article:published_time as requested by user\r\n        if (source === 'GhanaWeb') {\r\n            const gwDate = $('meta[property=\"article:published_time\"]').attr('content') ||\r\n                $('meta[property=\"og:article:published_time\"]').attr('content') ||\r\n                $('meta[itemprop=\"datePublished\"]').attr('content');\r\n            if (gwDate) dateStr = gwDate;\r\n        }\r\n\r\n        let timestamp: number | undefined;\r\n        let time: string | undefined;\r\n\r\n        if (dateStr) {\r\n            const parsed = parsePublicationDate(dateStr);\r\n            if (parsed.display !== 'Recent') {\r\n                timestamp = parsed.timestamp;\r\n                time = parsed.display;\r\n            }\r\n        }\r\n\r\n        // Content Extraction\r\n        let content = '';\r\n\r\n        if (source === '3News') {\r\n            const el = $('.article-content').first();\r\n            if (el.length > 0) {\r\n                // deeply remove specific unwanted 3news elements\r\n                el.find('.gam-ad-slot, .ad-viewability-tracker, ins.adsbygoogle, script, iframe, style').remove();\r\n\r\n                // Remove privacy managers, \"remove ads\" buttons/text\r\n                el.find('div, button, a').each((_, elem) => {\r\n                    const t = $(elem).text().toLowerCase();\r\n                    if (t.includes('remove ads') || t.includes('privacy manager') || t.includes('tap here to add 3news')) {\r\n                        $(elem).remove();\r\n                    }\r\n                });\r\n\r\n                // Get paragraphs\r\n                const paragraphs: string[] = [];\r\n                el.find('p').each((_, p) => {\r\n                    const t = $(p).text().trim();\r\n                    if (t.length > 5 && !t.toLowerCase().includes('read also') && !t.toLowerCase().includes('read more')) {\r\n                        paragraphs.push(`<p>${t}</p>`);\r\n                    }\r\n                });\r\n\r\n                content = paragraphs.join('');\r\n            }\r\n        }\r\n\r\n        if (!content) {\r\n            let contentSelector = '';\r\n            // if (source === '3News') contentSelector = '.prose'; // Handled above now\r\n            if (source === 'GhanaWeb') contentSelector = '#medsection1, .article-content-area';\r\n            else if (source === 'AdomOnline') contentSelector = '.td-post-content';\r\n            else if (source === 'MyJoyOnline') contentSelector = '#article-text';\r\n            else if (source === 'Yen' || source === 'yen.com.gh') contentSelector = '.js-article-body, .post-content';\r\n            else if (source === 'Pulse' || source === 'pulse.com.gh') contentSelector = 'article, .max-w-\\\\[620px\\\\], .article-content';\r\n\r\n            // Generic fallback selectors\r\n            if (!contentSelector) {\r\n                contentSelector = '.entry-content, .article-body, .post-content, .content-wrapper, article';\r\n            }\r\n\r\n            let contentEl = $(contentSelector).first();\r\n            if (contentEl.length === 0 && source === 'GhanaWeb') {\r\n                // Fallback for GhanaWeb\r\n                contentEl = $('p').parent().filter((i, el) => $(el).find('p').length > 3).first();\r\n            }\r\n\r\n            if (contentEl.length) {\r\n                // Remove unwanted elements\r\n                contentEl.find('script, style, iframe, .related-posts, .ads, .ad, [class*=\"ad-\"], [id*=\"ad-\"]').remove();\r\n\r\n                // Get paragraphs\r\n                const paragraphs: string[] = [];\r\n                contentEl.find('p').each((_, el) => {\r\n                    const text = $(el).text().trim();\r\n                    if (text.length > 20) { // Filter out short snippets/captions\r\n                        paragraphs.push(`<p>${text}</p>`);\r\n                    }\r\n                });\r\n                content = paragraphs.join('');\r\n            }\r\n        }\r\n\r\n        // ---------------------------------------------------------\r\n        // Fallback: Mozilla Readability\r\n        // ---------------------------------------------------------\r\n        if (!content || content.length < 100) {\r\n            const dom = new JSDOM(html, { url: link });\r\n            const reader = new Readability(dom.window.document);\r\n            const article = reader.parse();\r\n            if (article && article.content) {\r\n                // Readability returns HTML, but we might want to ensure it's clean\r\n                content = article.content;\r\n            }\r\n        }\r\n\r\n        return { image, timestamp, time, content };\r\n    } catch {\r\n        return { image: null };\r\n    }\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: GhanaWeb (Scrape Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeGhanaWeb(): Promise<Story[]> {\r\n    const sections = [\r\n        { name: 'News', url: 'https://www.ghanaweb.com/GhanaHomePage/NewsArchive/' },\r\n        { name: 'Sports', url: 'https://www.ghanaweb.com/GhanaHomePage/SportsArchive/' },\r\n        { name: 'Business', url: 'https://www.ghanaweb.com/GhanaHomePage/business/' }\r\n    ];\r\n\r\n    const stories: Story[] = [];\r\n    const seenLinks = new Set<string>();\r\n\r\n    await Promise.all(sections.map(async (sec) => {\r\n        try {\r\n            const res = await fetch(sec.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n            const html = await res.text();\r\n            const $ = cheerio.load(html);\r\n\r\n            let candidates = $('.inner-lead, .sub-menu-list__news li, .news_listing .inner, #leads .inner, .news-list li');\r\n\r\n            if (candidates.length === 0) {\r\n                candidates = $('a[href*=\"artikel.php\"], a[href*=\"/NewsArchive/\"], a[href*=\"/SportsArchive/\"], a[href*=\"/business/\"]');\r\n            }\r\n\r\n            candidates.slice(0, 10).each((_, el) => {\r\n                const a = $(el).is('a') ? $(el) : $(el).find('a').first();\r\n                const link = a.attr('href');\r\n                let title = a.attr('title') || a.text().trim();\r\n\r\n                if (!title || title.length < 5) {\r\n                    title = $(el).find('h2, h3, h4, p').text().trim();\r\n                }\r\n\r\n                let image = $(el).find('img').attr('src');\r\n                if (!image) {\r\n                    image = $(el).closest('div, li').find('img').attr('src');\r\n                }\r\n\r\n                let dateStr = $(el).find('.date, .time, time, .published, .post-date').first().text().trim();\r\n                if (!dateStr) {\r\n                    dateStr = $(el).find('time').attr('datetime') || '';\r\n                }\r\n                const { timestamp, display } = parsePublicationDate(dateStr);\r\n\r\n                const unwantedTitlePatterns = [\r\n                    'Home - News', 'Home - Business', 'Home - Sports', 'Home-Business',\r\n                    'Business archive', 'News Archive', 'Sports Archive', 'Photo Archives',\r\n                    'Archive', 'Category:', 'Section:', 'More News', 'More Stories',\r\n                    'View All', 'Latest News', 'Top Stories'\r\n                ];\r\n\r\n                const isUnwantedTitle = unwantedTitlePatterns.some(pattern =>\r\n                    title.toLowerCase().trim() === pattern.toLowerCase() ||\r\n                    title.toLowerCase().includes(pattern.toLowerCase())\r\n                );\r\n\r\n                const hasArticleId = link?.includes('artikel.php?ID=') ||\r\n                    /\\/\\d{7,}-/.test(link || '');\r\n\r\n                const hasSvgImage = image?.toLowerCase().endsWith('.svg');\r\n\r\n                if (link && title && title.length > 10 && !link.includes('javascript') && !link.includes('#') && !isUnwantedTitle && hasArticleId && !hasSvgImage) {\r\n                    const fullLink = resolveUrl('https://www.ghanaweb.com', link);\r\n                    if (seenLinks.has(fullLink)) return;\r\n                    seenLinks.add(fullLink);\r\n\r\n                    if (image) image = resolveUrl('https://cdn.ghanaweb.com', image);\r\n\r\n                    stories.push({\r\n                        id: `gw-${stories.length + Math.random()}`,\r\n                        source: 'GhanaWeb',\r\n                        title,\r\n                        link: fullLink,\r\n                        image: image || null,\r\n                        time: display,\r\n                        timestamp,\r\n                        section: sec.name\r\n                    });\r\n                }\r\n            });\r\n        } catch (e) {\r\n            console.error(`GhanaWeb ${sec.name} Error:`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: AdomOnline (RSS Sections)\r\n// ---------------------------------------------------------------------------\r\n// ---------------------------------------------------------------------------\r\n// Source: AdomOnline (RSS Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeAdomOnline(): Promise<Story[]> {\r\n    try {\r\n        const items = await fetchRSS('https://www.adomonline.com/feed/', 'AdomOnline', 'News');\r\n        return items.map(item => ({\r\n            id: `adom-${Math.random().toString(36).substr(2, 9)}`,\r\n            source: 'AdomOnline',\r\n            title: item.title,\r\n            link: item.link,\r\n            image: item.imageUrl || null,\r\n            time: timeAgo(new Date(item.pubDate).getTime()),\r\n            timestamp: new Date(item.pubDate).getTime(),\r\n            section: 'News',\r\n            content: item.content\r\n        }));\r\n    } catch (e) {\r\n        console.error('AdomOnline Error:', e);\r\n        return [];\r\n    }\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: PeaceFM (API)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapePeaceFM(): Promise<Story[]> {\r\n    try {\r\n        const response = await fetch('https://articles-engine.peacefmonline.com/v1/articles?limit=30', {\r\n            headers: { 'User-Agent': 'Mozilla/5.0' }\r\n        });\r\n        if (!response.ok) return [];\r\n\r\n        const json = await response.json();\r\n        if (json.status !== 'success' || !json.data) return [];\r\n\r\n        const articles = json.data.map((item: any) => {\r\n            const section = item.section?.section_location || 'local';\r\n            const category = item.category?.category_location || 'news';\r\n            const link = `https://www.peacefmonline.com/pages/${section}/${category}/${item.slug}`;\r\n\r\n            return {\r\n                id: `peace-${item.article_id}`,\r\n                source: 'PeaceFM',\r\n                title: item.main_title,\r\n                link: link,\r\n                image: item.main_photo?.photo_url || null,\r\n                time: timeAgo(new Date(item.created_at).getTime()),\r\n                section: item.section?.section_name || 'News',\r\n                timestamp: new Date(item.created_at).getTime()\r\n            };\r\n        });\r\n\r\n        return articles.filter((a: any) => a.title && a.link);\r\n    } catch (error) {\r\n        console.error('Error scraping PeaceFM:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: MyJoyOnline (HTML Scrape Sections)\r\n// ---------------------------------------------------------------------------\r\n// ---------------------------------------------------------------------------\r\n// Source: MyJoyOnline (RSS)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeMyJoyOnline(): Promise<Story[]> {\r\n    try {\r\n        const items = await fetchRSS('https://www.myjoyonline.com/feed/', 'MyJoyOnline', 'News');\r\n        return items.map(item => ({\r\n            id: `joy-${Math.random().toString(36).substr(2, 9)}`,\r\n            source: 'MyJoyOnline',\r\n            title: item.title,\r\n            link: item.link,\r\n            image: item.imageUrl || null,\r\n            time: timeAgo(new Date(item.pubDate).getTime()),\r\n            timestamp: new Date(item.pubDate).getTime(),\r\n            section: 'News',\r\n            content: item.content\r\n        }));\r\n    } catch (e) {\r\n        console.error('MyJoyOnline Error:', e);\r\n        return [];\r\n    }\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: 3News (RSS Feed)\r\n// ---------------------------------------------------------------------------\r\n// ---------------------------------------------------------------------------\r\n// Source: 3News (RSS Feed)\r\n// ---------------------------------------------------------------------------\r\nasync function scrape3News(): Promise<Story[]> {\r\n    try {\r\n        const items = await fetchRSS('https://3news.com/feed/', '3News', 'News');\r\n        return items.map(item => ({\r\n            id: `3news-${Math.random().toString(36).substr(2, 9)}`,\r\n            source: '3News',\r\n            title: item.title,\r\n            link: item.link,\r\n            image: item.imageUrl || null,\r\n            time: timeAgo(new Date(item.pubDate).getTime()),\r\n            timestamp: new Date(item.pubDate).getTime(),\r\n            section: 'News',\r\n            content: item.content\r\n        }));\r\n    } catch (e) {\r\n        console.error('3News Error:', e);\r\n        return [];\r\n    }\r\n}\r\n\r\nasync function scrapeDailyGuide(): Promise<{ stories: Article[], logs: string[] }> {\r\n    const stories: Article[] = [];\r\n    const logs: string[] = [];\r\n    try {\r\n        const items = await fetchRSS('https://dailyguidenetwork.com/feed/', 'DailyGuide', 'News');\r\n        items.forEach(item => {\r\n            stories.push({\r\n                id: `dailyguide-${Math.random().toString(36).substr(2, 9)}`,\r\n                source: 'DailyGuide',\r\n                title: item.title,\r\n                link: item.link,\r\n                image: item.imageUrl || null,\r\n                time: timeAgo(new Date(item.pubDate).getTime()),\r\n                timestamp: new Date(item.pubDate).getTime(),\r\n                section: 'News',\r\n                content: item.content\r\n            } as Article);\r\n        });\r\n        logs.push(`DailyGuide: Found ${items.length} items`);\r\n    } catch (e) {\r\n        logs.push(`DailyGuide Error: ${e}`);\r\n    }\r\n\r\n    return { stories, logs };\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: CitiNewsRoom (HTML Scrape Sections)\r\n// ---------------------------------------------------------------------------\r\nasync function scrapeCitiNewsRoom(): Promise<Story[]> {\r\n    const sections = [\r\n        { name: 'News', url: 'https://citinewsroom.com/news/' },\r\n        { name: 'Business', url: 'https://citinewsroom.com/category/business/' },\r\n        { name: 'Politics', url: 'https://citinewsroom.com/category/politics/' },\r\n        { name: 'Regional', url: 'https://citinewsroom.com/category/regional-news/' },\r\n        { name: 'Sports', url: 'https://citisportsonline.com/' }\r\n    ];\r\n\r\n    const stories: Story[] = [];\r\n    const seenLinks = new Set<string>();\r\n\r\n    await Promise.all(sections.map(async (sec) => {\r\n        try {\r\n            const res = await fetch(sec.url, { headers: { 'User-Agent': 'Mozilla/5.0' } });\r\n            const html = await res.text();\r\n            const $ = cheerio.load(html);\r\n\r\n            const articles = $('.jeg_post');\r\n\r\n            articles.slice(0, 15).each((_, el) => {\r\n                const titleEl = $(el).find('.jeg_post_title a').first();\r\n                const link = titleEl.attr('href');\r\n                let title = titleEl.text().trim();\r\n\r\n                let image = $(el).find('.jeg_thumb img').attr('data-src') ||\r\n                    $(el).find('.jeg_thumb img').attr('src');\r\n\r\n                // Handle lazy loading image variants\r\n                if (!image) {\r\n                    const srcset = $(el).find('.jeg_thumb img').attr('data-srcset');\r\n                    if (srcset) {\r\n                        const parts = srcset.split(',');\r\n                        if (parts.length > 0) {\r\n                            image = parts[parts.length - 1].trim().split(' ')[0];\r\n                        }\r\n                    }\r\n                }\r\n\r\n                let dateStr = $(el).find('.jeg_meta_date').text().trim();\r\n                const { timestamp, display } = parsePublicationDate(dateStr);\r\n\r\n                if (link && title && title.length > 5 && !seenLinks.has(link)) {\r\n                    seenLinks.add(link);\r\n\r\n                    // Specific section from article if available, otherwise generic section\r\n                    let category = $(el).find('.jeg_post_category span a').text().trim();\r\n                    if (!category) category = sec.name;\r\n\r\n                    // Explicitly skip Entertainment articles even if found in other sections\r\n                    if (category.toLowerCase().includes('entertainment') || link.toLowerCase().includes('/entertainment/')) {\r\n                        return;\r\n                    }\r\n\r\n                    stories.push({\r\n                        id: `citi-${stories.length + Math.random()}`,\r\n                        source: 'CitiNewsRoom',\r\n                        title,\r\n                        link: link,\r\n                        image: image || null,\r\n                        time: display,\r\n                        timestamp,\r\n                        section: category\r\n                    });\r\n                }\r\n            });\r\n        } catch (e) {\r\n            console.error(`CitiNewsRoom ${sec.name} Error:`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// Source: Generic RSS Scraper\r\n// ---------------------------------------------------------------------------\r\nconst GENERIC_FEEDS = [\r\n    { source: 'yen.com.gh', url: 'https://yen.com.gh/rss/all.rss', section: 'News' },\r\n    { source: 'pulse.com.gh', url: 'https://www.pulse.com.gh/rss-articles.xml', section: 'News' },\r\n    { source: 'GNA', url: 'https://gna.org.gh/feed/', section: 'News' },\r\n    { source: 'Graphic Online', url: 'https://www.graphic.com.gh/news/general-news?format=feed', section: 'News' },\r\n    { source: 'Ghanaian Times', url: 'https://www.ghanaiantimes.com.gh/feed/', section: 'News' },\r\n    { source: 'Starr FM', url: 'https://starrfm.com.gh/feed/', section: 'News' },\r\n    { source: 'News Ghana', url: 'https://newsghana.com.gh/feed/', section: 'News' },\r\n    { source: 'The B&FT', url: 'https://thebftonline.com/feed/', section: 'Business' },\r\n    { source: 'Atinka Online', url: 'https://atinkaonline.com/feed/', section: 'News' },\r\n    { source: 'Asaase Radio', url: 'https://asaaseradio.com/feed/', section: 'News' },\r\n    { source: 'The Herald', url: 'https://theheraldghana.com/feed/', section: 'News' },\r\n    { source: 'The Chronicle', url: 'https://thechronicle.com.gh/feed/', section: 'News' },\r\n    { source: 'GhPage', url: 'https://ghpage.com/feed/', section: 'Entertainment' },\r\n    { source: 'Ameyaw Debrah', url: 'https://ameyawdebrah.com/feed/', section: 'Entertainment' },\r\n    { source: 'YFM Ghana', url: 'https://yfmghana.com/feed/', section: 'Entertainment' },\r\n    { source: 'Happy Ghana', url: 'https://www.happyghana.com/feed/', section: 'News' },\r\n    { source: 'GhanaSoccerNet', url: 'https://ghanasoccernet.com/feed', section: 'Sports' }\r\n];\r\n\r\nasync function scrapeGenericRSS(): Promise<Story[]> {\r\n    const stories: Story[] = [];\r\n\r\n    await Promise.all(GENERIC_FEEDS.map(async (feed) => {\r\n        try {\r\n            const items = await fetchRSS(feed.url, feed.source, feed.section);\r\n            items.forEach(item => {\r\n                stories.push({\r\n                    id: `${feed.source.toLowerCase().replace(/\\s+/g, '')}-${Math.random().toString(36).substr(2, 9)}`,\r\n                    source: feed.source,\r\n                    title: item.title,\r\n                    link: item.link,\r\n                    image: item.imageUrl || null,\r\n                    time: timeAgo(new Date(item.pubDate).getTime()),\r\n                    timestamp: new Date(item.pubDate).getTime(),\r\n                    section: feed.section,\r\n                    content: item.content\r\n                });\r\n            });\r\n        } catch (e) {\r\n            console.error(`Generic RSS Error (${feed.source}):`, e);\r\n        }\r\n    }));\r\n\r\n    return stories;\r\n}\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n    // Secure the endpoint with a secret key\r\n    const authHeader = req.headers.authorization;\r\n    if (process.env.CRON_SECRET && authHeader !== `Bearer ${process.env.CRON_SECRET}`) {\r\n        return res.status(401).json({ success: false, message: 'Unauthorized' });\r\n    }\r\n\r\n    console.log('CRON: Starting scrape...');\r\n\r\n    const [ghanaStories, adomStories, peaceStories, joyStories, threeNewsStories, dailyGuideResult, citiStories, genericStories] = await Promise.all([\r\n        scrapeGhanaWeb(),\r\n        scrapeAdomOnline(),\r\n        scrapePeaceFM(),\r\n        scrapeMyJoyOnline(),\r\n        scrape3News(),\r\n        scrapeDailyGuide(),\r\n        scrapeCitiNewsRoom(),\r\n        scrapeGenericRSS()\r\n    ]);\r\n\r\n    const dailyGuideStories = dailyGuideResult.stories;\r\n\r\n    let allStories = [...ghanaStories, ...adomStories, ...peaceStories, ...joyStories, ...threeNewsStories, ...dailyGuideStories, ...citiStories, ...genericStories];\r\n\r\n    // Deduplicate by link\r\n    const uniqueMap = new Map();\r\n    allStories.forEach(s => uniqueMap.set(s.link, s));\r\n    allStories = Array.from(uniqueMap.values());\r\n\r\n    // Fuzzy deduplication: Remove stories with similar titles (same story from different sources)\r\n    const deduplicatedStories: Story[] = [];\r\n    let duplicatesRemoved = 0;\r\n\r\n    for (const story of allStories) {\r\n        if (!isDuplicateStory(story, deduplicatedStories, 0.75)) {\r\n            deduplicatedStories.push(story);\r\n        } else {\r\n            duplicatesRemoved++;\r\n        }\r\n    }\r\n\r\n    allStories = deduplicatedStories;\r\n    console.log(`CRON: Removed ${duplicatesRemoved} duplicate stories based on title similarity`);\r\n\r\n    // sort\r\n    allStories.sort((a, b) => b.timestamp - a.timestamp);\r\n\r\n    // Get existing links from database to skip already-processed articles\r\n    const existingLinks = await getAllLinks();\r\n    console.log(`CRON: Database has ${existingLinks.size} existing articles`);\r\n\r\n    // Filter out articles we already have\r\n    const newStories = allStories.filter(story => !existingLinks.has(story.link));\r\n    console.log(`CRON: Found ${newStories.length} new articles (skipped ${allStories.length - newStories.length} existing)`);\r\n\r\n    // Deep Fetch Metadata ONLY for NEW articles to ensure correct images and dates\r\n    const batch = newStories.slice(0, 20); // Limit to 20 articles per scrape to prevent Vercel 60s timeout\r\n\r\n    console.log(`CRON: Fetching metadata for ${batch.length} new articles...`);\r\n\r\n    await Promise.all(batch.map(async (story) => {\r\n        const metadata = await fetchArticleMetadata(story.link, story.source);\r\n\r\n        if (metadata.timestamp && metadata.time) {\r\n            story.timestamp = metadata.timestamp;\r\n            story.time = metadata.time;\r\n        }\r\n        if (metadata.image) {\r\n            story.image = metadata.image;\r\n        }\r\n        if (metadata.content) {\r\n            story.content = metadata.content;\r\n        }\r\n    }));\r\n\r\n\r\n    allStories.sort((a, b) => b.timestamp - a.timestamp);\r\n\r\n    allStories.forEach(story => {\r\n        if (story.image) {\r\n            story.image = story.image.trim();\r\n        }\r\n    });\r\n\r\n    // Filter out articles older than 7 days (prevents old stories from appearing)\r\n    const sevenDaysAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);\r\n    const recentStories = allStories.filter(story => story.timestamp >= sevenDaysAgo);\r\n    const oldStoriesFiltered = allStories.length - recentStories.length;\r\n    if (oldStoriesFiltered > 0) {\r\n        console.log(`CRON: Filtered out ${oldStoriesFiltered} articles older than 7 days`);\r\n    }\r\n\r\n    const storiesWithImages = recentStories.filter(story =>\r\n        story.image !== null &&\r\n        story.image !== '' &&\r\n        !story.image.toLowerCase().endsWith('.svg')\r\n    );\r\n    console.log(`CRON: Filtered -> ${storiesWithImages.length} articles to insert`);\r\n\r\n    const newArticlesCount = await insertArticles(storiesWithImages as Article[]);\r\n    console.log(`CRON: Added ${newArticlesCount} new articles`);\r\n\r\n    const deletedInvalid = await deleteInvalidArticles();\r\n    const deletedOld = await deleteOldArticles(500);\r\n    console.log(`CRON: Cleanup -> Removed ${deletedInvalid} invalid and ${deletedOld} old articles.`);\r\n\r\n    res.status(200).json({\r\n        success: true,\r\n        added: newArticlesCount,\r\n        cleaned_invalid: deletedInvalid,\r\n        cleaned_old: deletedOld\r\n    });\r\n}\r\n","import type { NextApiResponse } from '../../types'\nimport type { IncomingMessage, ServerResponse } from 'node:http'\n\nimport { sendError } from '../../server/api-utils'\nimport { RouteKind } from '../../server/route-kind'\nimport type { Span } from '../../server/lib/trace/tracer'\nimport { PagesAPIRouteModule } from '../../server/route-modules/pages-api/module.compiled'\n\nimport { hoist } from './helpers'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getTracer, SpanKind } from '../../server/lib/trace/tracer'\nimport { BaseServerSpan } from '../../server/lib/trace/constants'\nimport type { InstrumentationOnRequestError } from '../../server/instrumentation/types'\nimport { addRequestMeta } from '../../server/request-meta'\n\n// Re-export the handler (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export config.\nexport const config = hoist(userland, 'config')\n\n// Create and export the route module that will be consumed.\nconst routeModule = new PagesAPIRouteModule({\n  definition: {\n    kind: RouteKind.PAGES_API,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  userland,\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n})\n\nexport async function handler(\n  req: IncomingMessage,\n  res: ServerResponse,\n  ctx: {\n    waitUntil?: (prom: Promise<void>) => void\n  }\n): Promise<void> {\n  if (routeModule.isDev) {\n    addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint())\n  }\n  let srcPage = 'VAR_DEFINITION_PAGE'\n\n  // turbopack doesn't normalize `/index` in the page name\n  // so we need to to process dynamic routes properly\n  // TODO: fix turbopack providing differing value from webpack\n  if (process.env.TURBOPACK) {\n    srcPage = srcPage.replace(/\\/index$/, '') || '/'\n  }\n\n  const prepareResult = await routeModule.prepare(req, res, { srcPage })\n\n  if (!prepareResult) {\n    res.statusCode = 400\n    res.end('Bad Request')\n    ctx.waitUntil?.(Promise.resolve())\n    return\n  }\n\n  const { query, params, prerenderManifest, routerServerContext } =\n    prepareResult\n\n  try {\n    const method = req.method || 'GET'\n    const tracer = getTracer()\n\n    const activeSpan = tracer.getActiveScopeSpan()\n    const onRequestError =\n      routeModule.instrumentationOnRequestError.bind(routeModule)\n\n    const invokeRouteModule = async (span?: Span) =>\n      routeModule\n        .render(req, res, {\n          query: {\n            ...query,\n            ...params,\n          },\n          params,\n          allowedRevalidateHeaderKeys: process.env\n            .__NEXT_ALLOWED_REVALIDATE_HEADERS as any as string[],\n          multiZoneDraftMode: Boolean(process.env.__NEXT_MULTI_ZONE_DRAFT_MODE),\n          trustHostHeader: process.env\n            .__NEXT_TRUST_HOST_HEADER as any as boolean,\n          // TODO: get this from from runtime env so manifest\n          // doesn't need to load\n          previewProps: prerenderManifest.preview,\n          propagateError: false,\n          dev: routeModule.isDev,\n          page: 'VAR_DEFINITION_PAGE',\n\n          internalRevalidate: routerServerContext?.revalidate,\n\n          onError: (...args: Parameters<InstrumentationOnRequestError>) =>\n            onRequestError(req, ...args),\n        })\n        .finally(() => {\n          if (!span) return\n\n          span.setAttributes({\n            'http.status_code': res.statusCode,\n            'next.rsc': false,\n          })\n\n          const rootSpanAttributes = tracer.getRootSpanAttributes()\n          // We were unable to get attributes, probably OTEL is not enabled\n          if (!rootSpanAttributes) {\n            return\n          }\n\n          if (\n            rootSpanAttributes.get('next.span_type') !==\n            BaseServerSpan.handleRequest\n          ) {\n            console.warn(\n              `Unexpected root span type '${rootSpanAttributes.get(\n                'next.span_type'\n              )}'. Please report this Next.js issue https://github.com/vercel/next.js`\n            )\n            return\n          }\n\n          const route = rootSpanAttributes.get('next.route')\n          if (route) {\n            const name = `${method} ${route}`\n\n            span.setAttributes({\n              'next.route': route,\n              'http.route': route,\n              'next.span_name': name,\n            })\n            span.updateName(name)\n          } else {\n            span.updateName(`${method} ${srcPage}`)\n          }\n        })\n\n    // TODO: activeSpan code path is for when wrapped by\n    // next-server can be removed when this is no longer used\n    if (activeSpan) {\n      await invokeRouteModule(activeSpan)\n    } else {\n      await tracer.withPropagatedContext(req.headers, () =>\n        tracer.trace(\n          BaseServerSpan.handleRequest,\n          {\n            spanName: `${method} ${srcPage}`,\n            kind: SpanKind.SERVER,\n            attributes: {\n              'http.method': method,\n              'http.target': req.url,\n            },\n          },\n          invokeRouteModule\n        )\n      )\n    }\n  } catch (err) {\n    // we re-throw in dev to show the error overlay\n    if (routeModule.isDev) {\n      throw err\n    }\n    // this is technically an invariant as error handling\n    // should be done inside of api-resolver onError\n    sendError(res as NextApiResponse, 500, 'Internal Server Error')\n  } finally {\n    // We don't allow any waitUntil work in pages API routes currently\n    // so if callback is present return with resolved promise since no\n    // pending work\n    ctx.waitUntil?.(Promise.resolve())\n  }\n}\n"],"names":["sendError","RouteKind","PagesAPIRouteModule","hoist","userland","getTracer","SpanKind","BaseServerSpan","addRequestMeta","config","routeModule","definition","kind","PAGES_API","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","handler","req","res","ctx","isDev","hrtime","bigint","srcPage","TURBOPACK","replace","prepareResult","prepare","statusCode","end","waitUntil","Promise","resolve","query","params","prerenderManifest","routerServerContext","method","tracer","activeSpan","getActiveScopeSpan","onRequestError","instrumentationOnRequestError","bind","invokeRouteModule","span","render","allowedRevalidateHeaderKeys","__NEXT_ALLOWED_REVALIDATE_HEADERS","multiZoneDraftMode","Boolean","__NEXT_MULTI_ZONE_DRAFT_MODE","trustHostHeader","__NEXT_TRUST_HOST_HEADER","previewProps","preview","propagateError","dev","internalRevalidate","revalidate","onError","args","finally","setAttributes","rootSpanAttributes","getRootSpanAttributes","get","handleRequest","console","warn","route","name","updateName","withPropagatedContext","headers","trace","spanName","SERVER","attributes","url","err"],"mappings":"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","ignoreList":[2]}